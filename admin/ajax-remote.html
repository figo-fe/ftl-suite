<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AJAX-Remote</title>
<link rel="stylesheet" href="src/css/main.css" />
</head>
<body class="skin-blue sidebar-mini">
<div class="wrapper">
    <div class="content-wrapper content-inner">
        <section class="content-header">
            <h1>AJAX-Remote<small>Proxy Ajax to remote server</small></h1>
        </section>
        <div class="content">
            <div class="box box-primary">
                <div class="box-body">
                    <table class="table table-bordered table-hover">
                        <tbody id="list">
                            <tr><td><input type="text" placeholder="e.g. /api/login/info.do" class="form-control"></td></tr>
                        </tbody>
                    </table>
                </div>
                <div class="box-footer">
                    <button type="button" id="add" class="btn btn-primary">add</button>
                    <button type="button" id="save" class="btn btn-success">save</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="src/js/base.js"></script>
<script src="src/js/main.js"></script>
<script>
var $list = $('#list');
var fsconfig = {};
$.get('/fsconfig.json', function(data){
    fsconfig = data;
    var arr = data.proxyArr;
    var trList = '';
    arr.forEach(function(url){
        trList += '<tr>'+
            '<td><input type="text" value="'+ url +'" placeholder="e.g. /api/login/info.do" class="form-control"></td>'+
        '</tr>';
    });

    $list.prepend(trList);
},'json');

$('#add').on('click',function(){
    $list.append('<tr><td><input type="text" placeholder="e.g. /api/login/info.do" class="form-control"></td></tr>');
});

$('#save').on('click', function(){
    var arr = [], cont;
    $list.find('tr').each(function(){
        var url = $(this).find('input').val();
        url && arr.push(url);
    });
    fsconfig.proxyArr = arr;
    if(confirm('Confirm the following data:\n' + JSON.stringify(arr, null, 4))){
        $.post('/fsapi/savefile',{
            path: '/fsconfig.json',
            cont: JSON.stringify(fsconfig, null, 4)
        }, function(res){
            alert(res.msg);
            res.code == 200 && location.reload();
        },'json');
    }
});
</script>
</body>
</html>